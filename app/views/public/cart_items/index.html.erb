<h1>Public::CartItems#index</h1>
<p>Find me in app/views/public/cart_items/index.html.erb</p>

<%= link_to "カートを空にする", cart_items_destroy_all_path, method: :delete, "data-confirm" => "本当に削除しますか？", class: "btn btn-danger"%>
<label>商品名</label>
<label>単価(税込み)</label>
<label>数量</label>
<label>小計</label>

<% @cart_subtotal=0 %>
<% @cart_items.each do |cart_items| %>
  <%= cart_items.item.name %>
  <%= cart_items.item.with_tax_price %>
  <%= cart_items.amount %>

  <%= form_with model: cart_items, url: cart_item_path(cart_items.id), method: :patch do |f| %>
    <%= f.select :amount, *[1..10] %>
    <%= f.submit "変更", class: "btn btn-success" %>
  <% end %>

  <%= cart_items.subtotal %>

  <%= link_to "削除する", cart_item_path(cart_items.id), method: :delete, "data-confirm" => "本当に削除しますか？", class: "btn btn-danger"%>

  <% @cart_subtotal += cart_items.subtotal %>
<% end %>

<label>合計金額</label>
<%=  @cart_subtotal %>

<%= link_to "買い物を続ける",  items_path, class: "btn btn-primary" %>
<%= link_to "情報入力に進む",  new_order_path, class: "btn btn-success" %>
